$(function(){function i(t){return t?JSON.parse(t):{}}!function(){$("#goodsnum").text(0);var t=i($.cookie("carts")?$.cookie("carts"):""),o=0;for(var n in t)o+=parseInt(t[n].num);$("#goodsnum").text(o)}(),$("#carts").click(function(){$(window).attr("location","carts.html")}),$("#clearHistory").click(function(){$("#lookedgoods").remove(),$("#clearHistory").remove(),$("<p>没有历史记录！</p>").appendTo("#looked")}),$("#minus").click(function(){var t=$("#number").val();--t<1&&(t=1),$("#number").val(t)}),$("#plus").click(function(){var t=$("#number").val();99<++t&&(t=99,alert("数量最大为99！")),$("#number").val(t)}),$("#number").blur(function(){var t=$(this).val();/\D/.test(t)?t=1:99<t&&(t=99),$(this).val(t)}),$("#buy").click(function(){var t=$("#goodname").text(),o=$("#goodPrice1").text(),n=parseFloat(o.match(/(-?\d+)\.?\d+/g,"")[0]),r=parseInt($("#number").val()),c=$("#imgsrc").attr("src");if(0==$("#goodsnum").text())$("#goodsnum").text(r);else{var e=parseInt($("#goodsnum").text());e+=r,$("#goodsnum").text(e)}var a=i($.cookie("carts")?$.cookie("carts"):"");t in a?a[t].num=e:a[t]={name:t,price:n,num:r,src:c},$.cookie("carts",JSON.stringify(a),{expires:7,path:"/"})}),$("#buy").click(function(){$("#mark").show(),$("#alertbox span").click(function(){$("#mark").hide()}),$("#alertbox input").click(function(){$("#mark").hide()})})});